# ğŸ“‹ INSTRUCTION - HÆ°á»›ng Dáº«n PhÃ¡t Triá»ƒn Dá»± Ãn

> **LÆ°u Ã½ quan trá»ng**: Táº¥t cáº£ AI Agent/Model pháº£i tuÃ¢n thá»§ nghiÃªm ngáº·t cÃ¡c quy táº¯c trong file nÃ y khi generate code cho dá»± Ã¡n.

---

## ğŸ¯ NguyÃªn Táº¯c Chung

### 1. NgÃ´n Ngá»¯ Giao Tiáº¿p
- **LuÃ´n tráº£ lá»i báº±ng tiáº¿ng Viá»‡t**, trá»« khi ngÆ°á»i viáº¿t prompt báº±ng tiáº¿ng Anh
- Code comments cÃ³ thá»ƒ báº±ng tiáº¿ng Anh hoáº·c tiáº¿ng Viá»‡t (Æ°u tiÃªn tiáº¿ng Viá»‡t cho business logic)

### 2. XÃ¡c Äá»‹nh NgÆ°á»i DÃ¹ng
**Báº®T BUá»˜C**: NgÆ°á»i dÃ¹ng pháº£i thÃ´ng bÃ¡o tÃªn cá»§a mÃ¬nh **má»™t láº§n** khi báº¯t Ä‘áº§u session chat.

**Quy trÃ¬nh**:
1. Láº§n Ä‘áº§u tiÃªn generate code: AI agent pháº£i **há»i tÃªn** ngÆ°á»i dÃ¹ng náº¿u chÆ°a Ä‘Æ°á»£c cung cáº¥p
   - "Cho mÃ¬nh biáº¿t tÃªn cá»§a báº¡n Ä‘á»ƒ ghi vÃ o log nhÃ©? (VÃ­ dá»¥: PhDuy2005)"
2. CÃ¡c láº§n sau: AI agent sáº½ **nhá»› vÃ  sá»­ dá»¥ng láº¡i** tÃªn Ä‘Ã£ lÆ°u trong session chat
3. Náº¿u ngÆ°á»i dÃ¹ng Ä‘á»•i tÃªn, cáº§n thÃ´ng bÃ¡o rÃµ rÃ ng: "Tá»« giá» tÃ´i lÃ  {TÃŠN_Má»šI}"

**VÃ­ dá»¥**:
```
User (láº§n 1): "Táº¡o entity Product cho tÃ´i. TÃ´i lÃ  PhDuy2005"
AI: Ghi log vá»›i User: PhDuy2005

User (láº§n 2): "Táº¡o controller Product"
AI: Tá»± Ä‘á»™ng dÃ¹ng láº¡i User: PhDuy2005 tá»« session
```

### 3. Metadata Cho Code Generation
**Báº®T BUá»˜C**: Má»i Ä‘oáº¡n code Ä‘Æ°á»£c generate ra Ä‘á»u pháº£i cÃ³ header comment chá»©a:

```java
/**
 * Generated by: {TÃŠN_MODEL} (vÃ­ dá»¥: GitHub Copilot (Claude Sonnet 4.5), GPT-4)
 * Created by: {TÃŠN_NGÆ¯á»œI_THá»°C_HIá»†N_PROMPT}
 * Created at: {TIMESTAMP}
 * Purpose: {MÃ”_Táº¢_NGáº®N_Gá»ŒN}
 */
```

**LÆ°u Ã½**: Model name nÃªn bao gá»“m cáº£ engine náº¿u cÃ³ (vÃ­ dá»¥: GitHub Copilot (Claude Sonnet 4.5), GitHub Copilot (GPT-4o))

**VÃ­ dá»¥**:
```java
/**
 * Generated by: GitHub Copilot (Claude Sonnet 4.5)
 * Created by: PhDuy2005
 * Created at: 2026-01-03 10:30:00
 * Purpose: User service for authentication and user management
 */
@Service
public class UserService {
    // ...
}
```

### 4. Logging Sau Khi Thá»±c Hiá»‡n Prompt
Sau má»—i láº§n generate code, AI agent pháº£i ghi log vÃ o file `.github/logs/generation-log.md` theo format:

```markdown
## [YYYY-MM-DD HH:mm:ss] - {PROMPT_SUMMARY}
- **Model**: {TÃŠN_MODEL} (bao gá»“m engine náº¿u cÃ³)
- **User**: {TÃŠN_NGÆ¯á»œI_PROMPT}
- **Files Modified/Created**:
  - `path/to/file1.java`
  - `path/to/file2.java`
- **Description**: {MÃ”_Táº¢_CHI_TIáº¾T}
```

---

## ğŸ“ Coding Conventions

### 1. Naming Conventions

#### 1.1 Class Names
- **Entity/Table**: `PascalCase` - danh tá»« sá»‘ Ã­t
  ```java
  User.java, Role.java, Permission.java, GymMembership.java
  ```

- **DTO (Data Transfer Object)**:
  - Request DTO: `Req{EntityName}DTO.java`
  - Response DTO: `Res{EntityName}DTO.java`
  ```java
  ReqUserDTO.java          // Táº¡o/cáº­p nháº­t user
  ResUserDTO.java          // Response tráº£ vá» thÃ´ng tin user
  ReqLoginDTO.java         // Login request
  ResLoginDTO.java         // Login response
  ```

- **Controller**: `{EntityName}Controller.java`
  ```java
  UserController.java, RoleController.java
  ```

- **Service**: 
  - Interface: `{EntityName}Service.java`
  - Implementation: `{EntityName}ServiceImpl.java`
  ```java
  UserService.java, UserServiceImpl.java
  ```

- **Repository**: `{EntityName}Repository.java`
  ```java
  UserRepository.java, RoleRepository.java
  ```

#### 1.2 Variable Names
- **camelCase** cho táº¥t cáº£ biáº¿n vÃ  method
- TÃªn biáº¿n pháº£i **mÃ´ táº£ rÃµ rÃ ng** Ã½ nghÄ©a
  ```java
  // âœ… Good
  private String fullName;
  private LocalDateTime registrationDate;
  private List<Permission> userPermissions;
  
  // âŒ Bad
  private String fn;
  private LocalDateTime rd;
  private List<Permission> perms;
  ```

#### 1.3 Method Names
- Báº¯t Ä‘áº§u báº±ng Ä‘á»™ng tá»«: `get`, `set`, `create`, `update`, `delete`, `find`, `check`, `validate`
  ```java
  getUserById(Long id)
  createNewUser(ReqUserDTO dto)
  updateUserProfile(Long id, ReqUserDTO dto)
  deleteUser(Long id)
  findUserByEmail(String email)
  checkUserExists(String email)
  validateUserPermissions(Long userId)
  ```

#### 1.4 Enum Names
- **PascalCase** cho enum class
- **UPPER_SNAKE_CASE** cho enum values
  ```java
  public enum UserStatus {
      ACTIVE,
      INACTIVE,
      SUSPENDED,
      PENDING_VERIFICATION
  }
  
  public enum PaymentMethod {
      CREDIT_CARD,
      BANK_TRANSFER,
      CASH,
      E_WALLET
  }
  ```

#### 1.5 Constants
- **UPPER_SNAKE_CASE**
  ```java
  public static final String DEFAULT_ROLE = "USER";
  public static final int MAX_LOGIN_ATTEMPTS = 5;
  public static final long TOKEN_EXPIRATION_TIME = 864000L;
  ```

### 2. Package Structure
```
com.se100.GymAndPTManagement
â”œâ”€â”€ config/              # Configuration classes
â”œâ”€â”€ controller/          # REST Controllers
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ requestDTO/      # Request DTOs (ReqXxxDTO)
â”‚   â”œâ”€â”€ responseDTO/     # Response DTOs (ResXxxDTO)
â”‚   â””â”€â”€ table/           # JPA Entities
â”œâ”€â”€ repository/          # JPA Repositories
â”œâ”€â”€ service/             # Service interfaces & implementations
â”‚   â””â”€â”€ impl/            # Service implementations (optional)
â””â”€â”€ util/
    â”œâ”€â”€ annotation/      # Custom annotations
    â”œâ”€â”€ enums/           # Enum classes
    â””â”€â”€ error/           # Custom exceptions
```

---

## ğŸŒ API Response Format

**Chi tiáº¿t Ä‘áº§y Ä‘á»§**: Xem file [API_RESPONSE_FORMAT.md](./API_RESPONSE_FORMAT.md)

### TÃ³m táº¯t
- Táº¥t cáº£ endpoint pháº£i tráº£ vá» format chuáº©n
- Sá»­ dá»¥ng `FormatRestResponse` utility class
- **Báº®T BUá»˜C**: Má»i endpoint pháº£i cÃ³ annotation `@ApiMessage("MÃ´ táº£")`

```java
@GetMapping("/users/{id}")
@ApiMessage("Láº¥y thÃ´ng tin user theo ID")
public ResponseEntity<ResUserDTO> getUserById(@PathVariable Long id) {
    // ...
}
```

---

## ğŸ—„ï¸ Database Schema Guidelines

**Chi tiáº¿t Ä‘áº§y Ä‘á»§**: Xem file [DATABASE_SCHEMA.md](./DATABASE_SCHEMA.md)

### NguyÃªn Táº¯c Khi Generate Entity

âš ï¸ **Báº®T BUá»˜C**: TrÆ°á»›c khi generate Entity, pháº£i:
1. Kiá»ƒm tra file `DATABASE_SCHEMA.md` xem Ä‘Ã£ cÃ³ schema cho entity nÃ y chÆ°a
2. Náº¿u cÃ³ schema, generate theo Ä‘Ãºng schema Ä‘Ã£ Ä‘á»‹nh nghÄ©a
3. Náº¿u chÆ°a cÃ³ schema, Ä‘á» xuáº¥t schema vÃ  yÃªu cáº§u xÃ¡c nháº­n trÆ°á»›c khi generate
4. LuÃ´n bao gá»“m **Audit Fields** (created_at, updated_at, created_by, updated_by)

---

## âš™ï¸ Algorithm Guidelines

**Chi tiáº¿t Ä‘áº§y Ä‘á»§**: Xem file [ALGORITHMS.md](./ALGORITHMS.md)

### NguyÃªn Táº¯c Khi Generate Algorithm

âš ï¸ **Báº®T BUá»˜C**: TrÆ°á»›c khi generate thuáº­t toÃ¡n, pháº£i:
1. Kiá»ƒm tra file `ALGORITHMS.md` xem Ä‘Ã£ cÃ³ mÃ´ táº£ thuáº­t toÃ¡n tÆ°Æ¡ng tá»± chÆ°a
2. Náº¿u Ä‘Ã£ cÃ³, sá»­ dá»¥ng láº¡i thuáº­t toÃ¡n Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a
3. Náº¿u chÆ°a cÃ³, mÃ´ táº£ thuáº­t toÃ¡n chi tiáº¿t vÃ  yÃªu cáº§u xÃ¡c nháº­n trÆ°á»›c khi implement
4. Sau khi implement thuáº­t toÃ¡n má»›i, cáº­p nháº­t vÃ o file `ALGORITHMS.md`

---

## ğŸ—ï¸ Code Generation Rules

### 1. Generate Controller - Service - Repository

Khi Ä‘Æ°á»£c yÃªu cáº§u generate bá»™ **Controller - Service - Repository**:

#### âœ… CHá»ˆ ÄÆ¯á»¢C PHÃ‰P:
- Táº¡o class structure
- Thá»±c hiá»‡n **Dependency Injection**
- Khai bÃ¡o interface methods (khÃ´ng cÃ³ implementation)
- ThÃªm annotations cáº§n thiáº¿t (`@RestController`, `@Service`, `@Repository`, etc.)

#### âŒ KHÃ”NG ÄÆ¯á»¢C PHÃ‰P:
- Gá»£i Ã½ cÃ¡c hÃ m/method nÃ o cáº§n cÃ³
- Viáº¿t logic bÃªn trong method
- Implement báº¥t ká»³ business logic nÃ o
- Tá»± Ã½ thÃªm cÃ¡c method khÃ´ng Ä‘Æ°á»£c yÃªu cáº§u

#### VÃ­ dá»¥ ÄÃºng:

```java
/**
 * Generated by: GitHub Copilot
 * Created by: User Name
 * Created at: 2026-01-03 10:00:00
 * Purpose: User controller for user management
 */
@RestController
@RequestMapping("/api/v1/users")
public class UserController {
    
    private final UserService userService;
    
    public UserController(UserService userService) {
        this.userService = userService;
    }
    
    // Methods will be added based on specific requirements
}
```

```java
/**
 * Generated by: GitHub Copilot
 * Created by: User Name
 * Created at: 2026-01-03 10:00:00
 * Purpose: User service interface
 */
public interface UserService {
    // Methods will be defined based on specific requirements
}
```

```java
/**
 * Generated by: GitHub Copilot
 * Created by: User Name
 * Created at: 2026-01-03 10:00:00
 * Purpose: User service implementation
 */
@Service
public class UserServiceImpl implements UserService {
    
    private final UserRepository userRepository;
    
    public UserServiceImpl(UserRepository userRepository) {
        this.userRepository = userRepository;
    }
    
    // Implementation will be added based on specific requirements
}
```

```java
/**
 * Generated by: GitHub Copilot
 * Created by: User Name
 * Created at: 2026-01-03 10:00:00
 * Purpose: User repository
 */
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    // Custom query methods will be added based on specific requirements
}
```

### 2. Generate Entity

- LuÃ´n kiá»ƒm tra `DATABASE_SCHEMA.md` trÆ°á»›c
- Bao gá»“m Ä‘áº§y Ä‘á»§ audit fields
- Sá»­ dá»¥ng Lombok annotations: `@Data`, `@NoArgsConstructor`, `@AllArgsConstructor`, `@Builder`
- CÃ³ validation annotations khi cáº§n thiáº¿t

### 3. Generate DTO

**Request DTO** (ReqXxxDTO):
- Chá»©a cÃ¡c field cáº§n thiáº¿t cho request
- CÃ³ validation annotations: `@NotBlank`, `@NotNull`, `@Email`, `@Size`, etc.
- KhÃ´ng chá»©a field `id` (trá»« khi update)

**Response DTO** (ResXxxDTO):
- Chá»©a cÃ¡c field Ä‘Æ°á»£c phÃ©p tráº£ vá» cho client
- **KHÃ”NG BAO Gá»’M** sensitive data (password, secret keys, etc.)
- CÃ³ thá»ƒ cÃ³ nested DTOs

---

## ğŸ“š Reference Files

1. **[API_RESPONSE_FORMAT.md](./API_RESPONSE_FORMAT.md)** - Chi tiáº¿t format JSON response
2. **[DATABASE_SCHEMA.md](./DATABASE_SCHEMA.md)** - Database schema definitions
3. **[ALGORITHMS.md](./ALGORITHMS.md)** - Documented algorithms and business logic
4. **[generation-log.md](../logs/generation-log.md)** - Log of all code generations

---

## âœ… Checklist TrÆ°á»›c Khi Generate Code

- [ ] Äá»c ká»¹ yÃªu cáº§u vÃ  xÃ¡c Ä‘á»‹nh rÃµ scope
- [ ] Kiá»ƒm tra `DATABASE_SCHEMA.md` náº¿u liÃªn quan Ä‘áº¿n Entity
- [ ] Kiá»ƒm tra `ALGORITHMS.md` náº¿u liÃªn quan Ä‘áº¿n thuáº­t toÃ¡n
- [ ] Chuáº©n bá»‹ metadata: Model name, Creator name, Timestamp
- [ ] TuÃ¢n thá»§ naming conventions
- [ ] Náº¿u generate Controller-Service-Repository: CHá»ˆ táº¡o structure + DI
- [ ] ThÃªm `@ApiMessage` cho má»i endpoint
- [ ] Ghi log vÃ o `generation-log.md` sau khi hoÃ n thÃ nh

---

## ğŸš¨ LÆ°u Ã Quan Trá»ng

1. **KhÃ´ng tá»± Ã½ Ä‘oÃ¡n**: Náº¿u khÃ´ng rÃµ yÃªu cáº§u, há»i láº¡i ngÆ°á»i dÃ¹ng
2. **TuÃ¢n thá»§ quy táº¯c**: Má»i quy táº¯c trong file nÃ y lÃ  Báº®T BUá»˜C, khÃ´ng pháº£i gá»£i Ã½
3. **Consistency**: Giá»¯ nháº¥t quÃ¡n vá»›i code base hiá»‡n cÃ³
4. **Documentation**: LuÃ´n document code, Ä‘áº·c biá»‡t lÃ  business logic phá»©c táº¡p
5. **Security**: KhÃ´ng bao giá» log hoáº·c tráº£ vá» sensitive information

---

**Version**: 1.0  
**Last Updated**: 2026-01-03  
**Maintained by**: Development Team
